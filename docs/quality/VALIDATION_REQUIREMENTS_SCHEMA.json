{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CAWS Validation Requirements Schema",
  "type": "object",
  "required": [
    "validation_trust_score",
    "empirical_evidence",
    "test_completeness",
    "safety_validation",
    "performance_validation",
    "acceptance_criteria"
  ],
  "properties": {
    "validation_trust_score": {
      "type": "object",
      "required": ["overall", "components", "minimum_required"],
      "properties": {
        "overall": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Overall validation trust score"
        },
        "components": {
          "type": "object",
          "properties": {
            "empirical_performance": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0
            },
            "test_completeness": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0
            },
            "safety_validation": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0
            },
            "claim_accuracy": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0
            },
            "evidence_quality": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0
            }
          }
        },
        "minimum_required": {
          "type": "number",
          "const": 0.85,
          "description": "Minimum trust score required for acceptance"
        }
      }
    },
    "empirical_evidence": {
      "type": "object",
      "required": ["required", "benchmarks", "evidence_quality"],
      "properties": {
        "required": {
          "type": "boolean",
          "const": true
        },
        "benchmarks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "dataset_size", "metric", "threshold", "evidence"],
            "properties": {
              "name": { "type": "string" },
              "dataset_size": { "type": "string", "pattern": "^[0-9]+k?_files?$" },
              "metric": { "type": "string" },
              "threshold": { "type": "number" },
              "evidence": {
                "type": "object",
                "required": ["result", "confidence_interval", "p_value", "sample_size"],
                "properties": {
                  "result": { "type": "number" },
                  "confidence_interval": {
                    "type": "array",
                    "items": { "type": "number" },
                    "minItems": 2,
                    "maxItems": 2
                  },
                  "p_value": { "type": "number", "maximum": 0.05 },
                  "sample_size": { "type": "integer", "minimum": 1000 }
                }
              }
            }
          }
        },
        "evidence_quality": {
          "type": "object",
          "required": ["statistical_significance", "sample_adequacy", "measurement_accuracy"],
          "properties": {
            "statistical_significance": { "type": "number", "maximum": 0.05 },
            "sample_adequacy": { "type": "number", "minimum": 0.8 },
            "measurement_accuracy": { "type": "number", "minimum": 0.9 }
          }
        }
      }
    },
    "test_completeness": {
      "type": "object",
      "required": ["unit_coverage", "integration_coverage", "safety_coverage", "performance_coverage"],
      "properties": {
        "unit_coverage": {
          "type": "number",
          "minimum": 0.8,
          "description": "Branch coverage for unit tests"
        },
        "integration_coverage": {
          "type": "number",
          "minimum": 0.7,
          "description": "Integration test coverage"
        },
        "safety_coverage": {
          "type": "number",
          "minimum": 0.9,
          "description": "Safety mechanism test coverage"
        },
        "performance_coverage": {
          "type": "number",
          "minimum": 0.8,
          "description": "Performance validation coverage"
        }
      }
    },
    "safety_validation": {
      "type": "object",
      "required": ["atomic_operations", "error_recovery", "undo_functionality", "file_operations"],
      "properties": {
        "atomic_operations": {
          "type": "object",
          "required": ["validated", "test_results", "confidence"],
          "properties": {
            "validated": { "type": "boolean" },
            "test_results": { "type": "string" },
            "confidence": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
          }
        },
        "error_recovery": {
          "type": "object",
          "required": ["scenarios_tested", "recovery_rate", "evidence"],
          "properties": {
            "scenarios_tested": { "type": "integer", "minimum": 5 },
            "recovery_rate": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
            "evidence": { "type": "string" }
          }
        },
        "undo_functionality": {
          "type": "object",
          "required": ["transactions_tested", "restoration_rate", "evidence"],
          "properties": {
            "transactions_tested": { "type": "integer", "minimum": 10 },
            "restoration_rate": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
            "evidence": { "type": "string" }
          }
        },
        "file_operations": {
          "type": "object",
          "required": ["operations_tested", "safety_confirmed", "evidence"],
          "properties": {
            "operations_tested": { "type": "integer", "minimum": 100 },
            "safety_confirmed": { "type": "boolean" },
            "evidence": { "type": "string" }
          }
        }
      }
    },
    "performance_validation": {
      "type": "object",
      "required": ["large_dataset_testing", "memory_profiling", "scalability_testing", "claims_validation"],
      "properties": {
        "large_dataset_testing": {
          "type": "object",
          "required": ["datasets_tested", "sizes", "results", "scaling_factor"],
          "properties": {
            "datasets_tested": { "type": "integer", "minimum": 3 },
            "sizes": {
              "type": "array",
              "items": { "type": "string", "pattern": "^[0-9]+k?_files?$" },
              "minItems": 3
            },
            "results": { "type": "array", "items": { "type": "number" } },
            "scaling_factor": { "type": "number", "minimum": 0.5, "maximum": 2.0 }
          }
        },
        "memory_profiling": {
          "type": "object",
          "required": ["measurements", "efficiency", "pressure_handling"],
          "properties": {
            "measurements": { "type": "integer", "minimum": 100 },
            "efficiency": { "type": "number", "description": "bytes per file" },
            "pressure_handling": {
              "type": "object",
              "required": ["adaptive", "thresholds", "evidence"],
              "properties": {
                "adaptive": { "type": "boolean" },
                "thresholds": { "type": "array", "items": { "type": "number" } },
                "evidence": { "type": "string" }
              }
            }
          }
        },
        "scalability_testing": {
          "type": "object",
          "required": ["performance_scaling", "resource_usage", "evidence"],
          "properties": {
            "performance_scaling": { "type": "number", "minimum": 0.1, "maximum": 3.0 },
            "resource_usage": { "type": "array", "items": { "type": "number" } },
            "evidence": { "type": "string" }
          }
        },
        "claims_validation": {
          "type": "object",
          "required": ["claimed_vs_actual", "accuracy_score", "evidence"],
          "properties": {
            "claimed_vs_actual": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["claim", "actual", "difference", "validated"],
                "properties": {
                  "claim": { "type": "number" },
                  "actual": { "type": "number" },
                  "difference": { "type": "number" },
                  "validated": { "type": "boolean" }
                }
              }
            },
            "accuracy_score": { "type": "number", "minimum": 0.0, "maximum": 1.0 },
            "evidence": { "type": "string" }
          }
        }
      }
    },
    "acceptance_criteria": {
      "type": "object",
      "required": ["validation_required", "evidence_required", "minimum_trust_score"],
      "properties": {
        "validation_required": { "type": "boolean", "const": true },
        "evidence_required": { "type": "boolean", "const": true },
        "minimum_trust_score": { "type": "number", "const": 0.85 },
        "validation_gates": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Validation gates that must pass"
        },
        "evidence_artifacts": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Required validation artifacts"
        }
      }
    },
    "validation_gaps": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Identified validation gaps that need addressing"
    },
    "validation_actions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["action", "priority", "status", "assignee"],
        "properties": {
          "action": { "type": "string" },
          "priority": { "type": "string", "enum": ["high", "medium", "low"] },
          "status": { "type": "string", "enum": ["pending", "in_progress", "completed"] },
          "assignee": { "type": "string" },
          "due_date": { "type": "string", "format": "date" },
          "evidence": { "type": "string" }
        }
      },
      "description": "Actions required to complete validation"
    },
    "evidence_artifacts": {
      "type": "object",
      "properties": {
        "performance_benchmarks": {
          "type": "object",
          "required": ["file", "format", "size", "checksum"],
          "properties": {
            "file": { "type": "string" },
            "format": { "type": "string", "enum": ["json", "csv"] },
            "size": { "type": "integer" },
            "checksum": { "type": "string" }
          }
        },
        "safety_test_results": {
          "type": "object",
          "required": ["file", "scenarios_tested", "pass_rate"],
          "properties": {
            "file": { "type": "string" },
            "scenarios_tested": { "type": "integer" },
            "pass_rate": { "type": "number", "minimum": 0.0, "maximum": 1.0 }
          }
        },
        "statistical_analysis": {
          "type": "object",
          "required": ["file", "p_values", "confidence_intervals"],
          "properties": {
            "file": { "type": "string" },
            "p_values": { "type": "array", "items": { "type": "number" } },
            "confidence_intervals": { "type": "array", "items": { "type": "array" } }
          }
        }
      }
    }
  },
  "additionalProperties": false
}
