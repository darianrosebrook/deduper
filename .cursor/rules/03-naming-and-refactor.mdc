---
description: Canonical naming; forbid enhanced/new/final forks; refactor rules
globs:
alwaysApply: true
---

# Canonical Naming & Refactor Rules

## No Duplicate/Fork Names

Reject or remove modules/files named with these modifiers:
`enhanced | unified | simplified | better | new | next | final | copy | revamp | improved` (case-insensitive).

**Why these patterns are problematic:**
- Create confusion about which version is current
- Lead to import errors and maintenance overhead
- Indicate incomplete refactoring or unclear requirements
- Violate single source of truth principle

**Pre-flight check (human-run or agent-run shell):**

```bash
# Check for banned naming patterns in filenames and symbols
rg -n --no-ignore -g '!node_modules' '(?i)(enhanced|unified|better|new|next|final|copy|revamp|improved).*\.(rs|ts|tsx|js|jsx|mjs|cjs|mts|cts|py|go|java|cpp|c|h)$'
```

**If hits exist in proposed filenames/symbols:**
1. **Block the change** - Do not create files with these patterns
2. **Use purpose-first canonical names** - Name based on functionality, not version
3. **Edit existing modules** - Refactor in-place rather than creating duplicates

## Refactor Strategy

- **Merge, then delete**: If two files cover one domain, merge into the canonical name, update imports, remove the duplicate.
- Prefer **Strategy pattern** + feature flags over file forks.
- Every refactor must include tests proving no behavior change (or updated tests + CHANGELOG if behavior changes).

## Naming Guidelines

**Good canonical names:**
- `pdf-processor.ts` (not `enhanced-pdf-processor.ts`)
- `auth-service.ts` (not `new-auth-service.ts`)
- `data-validator.ts` (not `improved-validator.ts`)

**Purpose-first naming:**
- Focus on what the module does, not when it was created or how it was forked
- Use descriptive, functional names
- Avoid temporal or comparative modifiers

## Acceptance

- No banned modifiers present in filenames or public symbols.
- Imports updated; build is green.
- Duplicates removed from tree.
- All references updated to use canonical names.
